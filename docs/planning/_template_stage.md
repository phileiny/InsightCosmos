# Stage {N}: {阶段名称}

> **阶段编号**: Stage {N}
> **阶段目标**: {一句话描述目标}
> **前置依赖**: Stage {N-1} 完成
> **预计时间**: {X} 天
> **状态**: Planning

---

## 🎯 阶段目标

### 核心目标

{详细描述这个阶段要达成的核心目标，3-5 句话}

### 为什么需要这个阶段？

{解释这个阶段在整体项目中的价值和必要性}

---

## 📥 输入 (Input)

### 来自上一阶段的产出

- **Stage {N-1}**:
  - {具体的文件/数据/功能}
  - {具体的文件/数据/功能}

### 外部依赖

- **技术依赖**:
  - {需要的库/框架/服务}

- **配置依赖**:
  - {需要的环境变量/配置}

- **数据依赖**:
  - {需要的测试数据/资源}

---

## 📤 输出 (Output)

### 代码产出

```
{预期的文件结构}
src/
└─ {module}/
    ├─ {file1}.py
    └─ {file2}.py
```

### 文档产出

- `docs/implementation/stage{N}_notes.md` - 实作笔记
- `docs/validation/stage{N}_test_report.md` - 测试报告

### 功能产出

- [ ] {功能点 1}
- [ ] {功能点 2}
- [ ] {功能点 3}

---

## 🏗️ 技术设计

### 架构图

```
{如适用，绘制架构图}
```

### 核心组件

#### 组件 1: {名称}

**职责**: {一句话描述}

**接口设计**:

```python
def component_function(param1: Type1, param2: Type2) -> ReturnType:
    """
    {功能描述}

    Args:
        param1: {说明}
        param2: {说明}

    Returns:
        {返回值说明}

    Raises:
        {可能的异常}

    Example:
        >>> component_function(val1, val2)
        {期望输出}
    """
    pass
```

**输入格式**:

```python
{
    "field1": type,  # 说明
    "field2": type   # 说明
}
```

**输出格式**:

```python
{
    "status": "success" | "error",
    "data": {...},           # 成功时
    "error_message": str,    # 失败时
    "suggestion": str        # 失败时的建议
}
```

**错误处理**:

| 错误类型 | 处理方式 | 返回信息 |
|---------|---------|---------|
| {错误 1} | {处理方式} | {用户友好的错误信息} |
| {错误 2} | {处理方式} | {用户友好的错误信息} |

#### 组件 2: {名称}

{重复上述结构}

---

## 🔧 实作细节

### 步骤 1: {步骤名称}

**目标**: {一句话描述}

**实作要点**:
- {要点 1}
- {要点 2}

**代码示例**:

```python
# {简要说明}
{示例代码}
```

### 步骤 2: {步骤名称}

{重复上述结构}

---

## 🧪 测试策略

### 单元测试

**测试文件**: `tests/unit/test_{module}.py`

**测试案例清单**:

| 测试案例 ID | 测试内容 | 输入 | 期望输出 | 优先级 |
|-----------|---------|------|---------|--------|
| TC-{N}-01 | {测试内容} | {输入} | {期望} | High |
| TC-{N}-02 | {测试内容} | {输入} | {期望} | High |
| TC-{N}-03 | {测试内容} | {输入} | {期望} | Medium |

**关键测试场景**:

1. **正常场景**: {描述}
   ```python
   # 测试代码示例
   ```

2. **边界场景**: {描述}
   ```python
   # 测试代码示例
   ```

3. **异常场景**: {描述}
   ```python
   # 测试代码示例
   ```

### 集成测试

**测试场景**: {描述如何与其他组件集成测试}

**测试数据**: {说明需要的测试数据}

---

## ✅ 验收标准 (Acceptance Criteria)

### 功能验收

- [ ] {功能点 1} 正常工作
- [ ] {功能点 2} 正常工作
- [ ] {功能点 3} 正常工作

### 质量验收

- [ ] 单元测试通过率 = 100%
- [ ] 代码覆盖率 >= {X}%
- [ ] 所有函数有完整 docstring
- [ ] 所有函数有类型标注
- [ ] 错误处理覆盖主要场景

### 性能验收

- [ ] {性能指标 1}: {标准}
- [ ] {性能指标 2}: {标准}

### 文档验收

- [ ] 代码注释完整清晰
- [ ] 实作笔记记录关键决策
- [ ] API 文档更新

---

## 🚧 风险与挑战

### 已知风险

| 风险 | 影响 | 缓解方案 |
|------|------|---------|
| {风险 1} | {影响描述} | {如何缓解} |
| {风险 2} | {影响描述} | {如何缓解} |

### 技术挑战

1. **挑战 1**: {描述}
   - **解决方案**: {方案}

2. **挑战 2**: {描述}
   - **解决方案**: {方案}

---

## 📚 参考资料

### 技术文档

- [ADK 相关文档](https://google.github.io/adk-docs/...)
- [第三方库文档](...)

### 内部参考

- `docs/reference/5D_AI_Agent_Summary.md` - {相关章节}
- `claude.md` - {相关规范}

### 示例代码

- {如有参考代码，提供链接或说明}

---

## 📝 开发清单 (Checklist)

### 规划阶段 ✓

- [x] 完成本规划文档
- [x] 评审通过

### 实作阶段

- [ ] 建立文件结构
- [ ] 实现核心组件 1
- [ ] 实现核心组件 2
- [ ] 编写单元测试
- [ ] 代码自测通过
- [ ] 更新 `dev_log.md`

### 验证阶段

- [ ] 单元测试全部通过
- [ ] 集成测试通过
- [ ] 人工验收通过
- [ ] 完成测试报告
- [ ] 文档更新完成

---

## 🎯 下一步行动

### 立即开始

1. {具体的第一步}
2. {具体的第二步}
3. {具体的第三步}

### 准备工作

- {需要准备的资源/工具/数据}

---

## 📊 时间分配

| 阶段 | 预计时间 | 占比 |
|------|---------|------|
| 规划 | {X} 小时 | 20% |
| 实作 | {Y} 小时 | 60% |
| 验证 | {Z} 小时 | 20% |
| **总计** | **{Total}** 小时 | **100%** |

---

**创建日期**: {YYYY-MM-DD}
**最后更新**: {YYYY-MM-DD}
**负责人**: Ray 张瑞涵
**状态**: Planning → Implementation → Validation → Done
